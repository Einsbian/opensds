<div class="table-toolbar">
    <div class="left">
        <button pButton type="button" label="Create" (click)="showUserForm()" class="ui-button-secondary"></button>
        <button pButton type="button" label="Delete" [disabled]="selectedUsers.length==0?'disabled':''" (click)="deleteUsers(selectedUsers)"></button>
    </div>
    <div class="right">
        <div class="ui-inputsearch">
            <input type="text" pInputText placeholder="search">
            <button pButton type="button" icon="fa-search"></button>
        </div>
        <button class="" pButton type="button" icon="fa-check"></button>
    </div>
</div>

<p-dataTable [immutable]="false" [(selection)]="selectedUsers" [sortField]="sortField" [value]="tenantUsers" selectionMode="multiple" [showHeaderCheckbox]="true" expandableRows="true" rowExpandMode="single" [rows]="10" [paginator]="true" [pageLinks]="3" [rowsPerPageOptions]="[10,20,50,100]" (onRowExpand)="onRowExpand($event)">
    <p-column expander="true" styleClass="col-icon" [style]="{'width': '60px'}"></p-column>
    <p-column selectionMode="multiple" [style]="{'width': '60px'}"></p-column>
    <p-column field="username" header="Username"></p-column>
    <p-column header="Status">
        <ng-template let-user="rowData" pTemplate="body">
            <span>{{(user.enabled == true) ? "Enabled" : "Disabled"}}</span>
        </ng-template>
    </p-column>
    <p-column field="description" header="Description"></p-column>
    <p-column header="Operation" [style]="{'width': '20%'}">
        <ng-template let-user="rowData" pTemplate="body">
            <a (click)="showUserForm(user)">Modify</a>
            <a (click)="userStatus(user.userid, user.enabled)">{{ (user.enabled == true) ? "Disable" : "Enable" }}</a>
            <a (click)="deleteUsers(user.userid)">Delete</a>
        </ng-template>
    </p-column>

    <ng-template pTemplate="rowexpansion">
        <user-detail [isUserDetailFinished]="isUserDetailFinished" [detailUserInfo]="detailUserInfo"></user-detail>
    </ng-template>
</p-dataTable>

<p-dialog [contentStyle]="{'overflow':'visible'}" [header]="popTitle" [(visible)]="createUserDisplay" [width]="500" modal="modal">
    <div>
        <div class="ui-inputgroup">
            <span class="ui-g-4 ui-md-4">{{label.userNameLabel}}</span>
            <input *ngIf="!isEditUser" type="text" [(ngModel)]="username" pInputText placeholder="Username" />
            <span *ngIf="isEditUser">{{ username }}</span>
        </div>
        <div class="ui-inputgroup margin-top-1em">
            <span class="ui-g-4 ui-md-4">{{label.descriptionLabel}}</span>
            <textarea [(ngModel)]="description" [rows]="3" [cols]="30" pInputTextarea ></textarea>
        </div>
        <div class="ui-inputgroup margin-top-1em">
            <span class="ui-g-4 ui-md-4">{{label.tenantLabel}}</span>
            <p-dropdown [options]="tenantLists" [(ngModel)]="selectedTenant" aria-placeholder="Select a Tentant"></p-dropdown>
        </div>

        <div class="ui-inputgroup margin-top-1em">
            <span class="ui-g-4 ui-md-4">{{label.passwordLabel}}</span>
            <input type="password" [(ngModel)]="newPassword" pPassword />
        </div>
        <div class="ui-inputgroup margin-top-1em">
            <span class="ui-g-4 ui-md-4">{{label.confirmPasswordLabel}}</span>
            <input type="password" pPassword [(ngModel)]="passwordConfirm" />
        </div>
    </div>
    <p-footer ngStyle="border:none;">
        <button type="button" pButton (click)="createUser()" label="OK"></button>
        <button type="button" pButton (click)="createUserDisplay=false" label="Cancel"></button>
    </p-footer>
</p-dialog>
<p-confirmDialog></p-confirmDialog>